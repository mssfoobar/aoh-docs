"use strict";(self.webpackChunkaoh_documentation=self.webpackChunkaoh_documentation||[]).push([[4937],{35526:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>a,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var t=o(74848),n=o(28453);const i={sidebar_position:10},s="Setup Service Infra Repository",c={id:"development/devops_onboard/setup-service-infra",title:"Setup Service Infra Repository",description:"Introduction",source:"@site/docs/20_development/51_devops_onboard/10-setup-service-infra.md",sourceDirName:"20_development/51_devops_onboard",slug:"/development/devops_onboard/setup-service-infra",permalink:"/aoh-docs/docs/development/devops_onboard/setup-service-infra",draft:!1,unlisted:!1,editUrl:"https://github.com/mssfoobar/aoh-docs/tree/main/docs/20_development/51_devops_onboard/10-setup-service-infra.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"development",previous:{title:"Introduction",permalink:"/aoh-docs/docs/development/devops_onboard/intro"},next:{title:"Update Project Infra Repository",permalink:"/aoh-docs/docs/development/devops_onboard/update-project-infra"}},a={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Setting up the service infra repository",id:"setting-up-the-service-infra-repository",level:2},{value:"Create a new service infra repository directly from template using Github web console",id:"create-a-new-service-infra-repository-directly-from-template-using-github-web-console",level:3},{value:"Create a new service infra repository from template by cloning to local",id:"create-a-new-service-infra-repository-from-template-by-cloning-to-local",level:3}];function l(e){const r={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h1,{id:"setup-service-infra-repository",children:"Setup Service Infra Repository"}),"\n",(0,t.jsx)(r.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(r.admonition,{type:"note",children:(0,t.jsxs)(r.p,{children:["The Service Infra Repository serves as an extension of the Project Infrastructure Repository, and can be referenced by the latter.",(0,t.jsx)(r.br,{}),"\n","For instructions to setup the project infrastructure, refer ",(0,t.jsx)(r.a,{href:"../../deployment/overview",children:"here"}),"."]})}),"\n",(0,t.jsxs)(r.p,{children:["This guide provides instructions on how to create a ",(0,t.jsx)(r.strong,{children:"new"})," service infrastructure repository in an ",(0,t.jsx)(r.strong,{children:"existing"})," project."]}),"\n",(0,t.jsx)(r.p,{children:"The Service Infra Repository contains IaC which determine how the service (container image) shall be deployed.\nAs part of the CI, the service's IaC is updated when a service's container image is successfully built as a result of changes to the service's source code."}),"\n",(0,t.jsx)(r.h1,{id:"create-service-infra-repository",children:"Create Service Infra Repository"}),"\n",(0,t.jsxs)(r.p,{children:["The following instructions assume that you are\ncreating the service infra repo for a service called ",(0,t.jsx)(r.code,{children:"MYSERVICE"}),"."]}),"\n",(0,t.jsx)(r.h2,{id:"setting-up-the-service-infra-repository",children:"Setting up the service infra repository"}),"\n",(0,t.jsxs)(r.p,{children:["The new repository can be created by ",(0,t.jsx)("u",{children:(0,t.jsx)(r.strong,{children:"one"})})," of the following means:"]}),"\n",(0,t.jsx)(r.h3,{id:"create-a-new-service-infra-repository-directly-from-template-using-github-web-console",children:"Create a new service infra repository directly from template using Github web console"}),"\n",(0,t.jsxs)(r.p,{children:["Create repository directly from template\nThe ",(0,t.jsx)(r.code,{children:"aoh-service-infra-template"})," repository exist as a GitHub template. If you are hosting your source code on GitHub, you can go to\nthe respective repository links and click ",(0,t.jsx)(r.code,{children:"Use this template"})," to create a new repository directly from the template."]}),"\n",(0,t.jsxs)(r.p,{children:["After that, clone the repository to local.",(0,t.jsx)(r.br,{}),"\n","Customize template for new repo."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./init-template.sh <PROJECT_NAME> <SERVICE_NAME>\n"})}),"\n",(0,t.jsx)(r.p,{children:"then commit and push the changes."}),"\n",(0,t.jsx)(r.h3,{id:"create-a-new-service-infra-repository-from-template-by-cloning-to-local",children:"Create a new service infra repository from template by cloning to local"}),"\n",(0,t.jsxs)(r.p,{children:["Pre-create empty service infra repository (using name format ",(0,t.jsx)(r.code,{children:"<PROJECT>-<SERVICE>-infra"}),") on Github and then use service infra template repository to populate it."]}),"\n",(0,t.jsxs)(r.p,{children:["Clone ",(0,t.jsx)(r.code,{children:"aoh-service-infra-template"})," repository to local."]}),"\n",(0,t.jsx)(r.admonition,{type:"note",children:(0,t.jsxs)(r.p,{children:["For AOH core development, use this:",(0,t.jsx)(r.br,{}),"\n",(0,t.jsx)(r.code,{children:"git clone https://github.com/mssfoobar/aoh-service-infra-template"})]})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"# Use this for non-AOH-core development\ngit clone https://github.com/DoisKoh/aoh-service-infra-template\n"})}),"\n",(0,t.jsx)(r.p,{children:"Customize template for new repo."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./init-template.sh <PROJECT_NAME> <SERVICE_NAME>\n"})}),"\n",(0,t.jsx)(r.p,{children:"Then rename and publish repository"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"./init-repo.sh <PROJECT_NAME> <SERVICE_NAME>\n"})}),"\n",(0,t.jsx)(r.h1,{id:"configure-service-infra-repository",children:"Configure Service Infra Repository"}),"\n",(0,t.jsxs)(r.p,{children:["With reference to ",(0,t.jsx)(r.code,{children:"docker-compose.yml"})," file in ",(0,t.jsx)(r.code,{children:"service"}),"'s source code repository, configure ",(0,t.jsx)(r.code,{children:"dev/helm/values.yaml"})," file in the ",(0,t.jsx)(r.code,{children:"service-infra"})," repository that was setup in the previous step.\nSearch for ",(0,t.jsx)(r.code,{children:"UPDATE THIS SECTION"})," for areas to be updated."]})]})}function p(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,r,o)=>{o.d(r,{R:()=>s,x:()=>c});var t=o(96540);const n={},i=t.createContext(n);function s(e){const r=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);