<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-iam/roles_and_groups">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Roles &amp; Groups | AGIL Ops Hub</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mssfoobar.github.io/aoh-docs/docs/iam/roles_and_groups"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Roles &amp; Groups | AGIL Ops Hub"><meta data-rh="true" name="description" content="Keycloak has the concept of Roles and Groups; a user can have roles or groups, and a group can contain multiple roles."><meta data-rh="true" property="og:description" content="Keycloak has the concept of Roles and Groups; a user can have roles or groups, and a group can contain multiple roles."><link data-rh="true" rel="icon" href="/aoh-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mssfoobar.github.io/aoh-docs/docs/iam/roles_and_groups"><link data-rh="true" rel="alternate" href="https://mssfoobar.github.io/aoh-docs/docs/iam/roles_and_groups" hreflang="en"><link data-rh="true" rel="alternate" href="https://mssfoobar.github.io/aoh-docs/docs/iam/roles_and_groups" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/aoh-docs/assets/css/styles.f531473f.css">
<link rel="preload" href="/aoh-docs/assets/js/runtime~main.6a155c06.js" as="script">
<link rel="preload" href="/aoh-docs/assets/js/main.6e0e3931.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/aoh-docs/"><b class="navbar__title text--truncate">AGIL Ops Hub</b></a><a class="navbar__item navbar__link" href="/aoh-docs/docs/overview/introduction">Overview</a><a class="navbar__item navbar__link" href="/aoh-docs/docs/development/introduction">Development</a><a class="navbar__item navbar__link" href="/aoh-docs/docs/deployment/overview">Deployment</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/aoh-docs/docs/iam/introduction">IAM</a><a class="navbar__item navbar__link" href="/aoh-docs/docs/ucs/introduction">UCS</a><a class="navbar__item navbar__link" href="/aoh-docs/docs/gis/introduction">GIS</a><a class="navbar__item navbar__link" href="/aoh-docs/docs/rnr/introduction">RNR</a><a class="navbar__item navbar__link" href="/aoh-docs/docs/wfe/introduction">WFE</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/aoh-docs/docs/gis/introduction">Next</a><a href="https://github.com/mssfoobar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aoh-docs/docs/iam/introduction">ðŸ†• Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aoh-docs/docs/iam/clients">Administering OIDC Clients</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/aoh-docs/docs/iam/roles_and_groups">Roles &amp; Groups</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_BDYx"><div class="docItemContainer_oq1c"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/aoh-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Roles &amp; Groups</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="row"><div class="col col--12"><h1>Roles &amp; Groups</h1><p>Keycloak has the concept of Roles and Groups; a user can have roles or groups, and a group can contain multiple roles.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="roles-in-aoh-agil-ops-hub">Roles in AOH (AGIL Ops Hub)<a class="hash-link" href="#roles-in-aoh-agil-ops-hub" title="Direct link to heading">â€‹</a></h2><p>As explained in the <a href="/aoh-docs/docs/iam/introduction#authentication-in-agil-rad">introduction</a>, AGIL Ops Hub uses roles,
and allows users have different roles depending on what team they are in. These roles are match the roles in Hasura
and is used to evaluate permission policies that control what tables the user is allowed to access. Combined with
Hasura&#x27;s custom check for permissions, we have the ability to very flexibly control what tables users are allowed to
access.</p><p>The roles in AGIL Ops Hub map directly to roles in Keycloak - they are the same. However, the way we use groups in
keycloak is the same as roles. This is due to a quirk of how Keycloak assigns attributes to users - it does not merge
attributes from roles into the user attributes, but it does so from the groups. This means that if we want to create
custom claims based on the user&#x27;s role by reading their role attributes, it won&#x27;t work. This is why we put users in
groups as if they are their role.</p><p>However, we still have to give users a role, as users are only allowed to assume roles based on their
<code>x-hasura-allowed-role</code> claim.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-new-role">Creating a new role<a class="hash-link" href="#creating-a-new-role" title="Direct link to heading">â€‹</a></h2><p>To create a new role, you must create both a role, and a matching group, and assign the `default-role`` attribute in
that group.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-role-in-keycloak">Creating a role in Keycloak<a class="hash-link" href="#creating-a-role-in-keycloak" title="Direct link to heading">â€‹</a></h3><ol><li>Click <code>Realm roles</code> on the left menu</li><li>Click <code>Create role</code></li><li>Give the role a name and helpful description</li><li>Click save</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-group-in-keycloak">Creating a group in Keycloak<a class="hash-link" href="#creating-a-group-in-keycloak" title="Direct link to heading">â€‹</a></h3><ol><li>Click <code>Groups</code> on the left</li><li>Click <code>Create group</code></li><li>Give your group a name, this should match the role (to avoid confusion)</li><li>Click on your newly created group</li><li>Click on the <code>attributes</code> tab</li><li>Create a new key, value pair with the key as <code>default-role</code> and the value as the name of your role</li></ol></div></div></div><div class="col col--12"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mssfoobar/aoh-docs/tree/main/docs/iam/roles_and_groups.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></div></article><div class="col col--12"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/aoh-docs/docs/iam/clients"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Administering OIDC Clients</div></a></nav></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#roles-in-aoh-agil-ops-hub" class="table-of-contents__link toc-highlight">Roles in AOH (AGIL Ops Hub)</a></li><li><a href="#creating-a-new-role" class="table-of-contents__link toc-highlight">Creating a new role</a><ul><li><a href="#creating-a-role-in-keycloak" class="table-of-contents__link toc-highlight">Creating a role in Keycloak</a></li><li><a href="#creating-a-group-in-keycloak" class="table-of-contents__link toc-highlight">Creating a group in Keycloak</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/mssfoobar" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organisation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.stengg.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ST Engineering<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 | ST Engineering</div></div></div></footer></div>
<script src="/aoh-docs/assets/js/runtime~main.6a155c06.js"></script>
<script src="/aoh-docs/assets/js/main.6e0e3931.js"></script>
</body>
</html>